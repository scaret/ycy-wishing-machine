<!doctype html>
<html>
<head>

</head>
<body style="margin: 0;">
<div id="video-container"></div>
<script src="../../vendor/AgoraRTCSDK-2.6.0.js"></script>
<script src="../../vendor/eruda.js"></script>
<script>
    eruda.init();
    AgoraRTC.getSupportedCodec().then(console.log);
</script>
<script>
    var client = AgoraRTC.createClient({mode: "rtc", codec: "vp8"});
    client.init("b7db71a6d9724c3f940cbcddcbd2b09d", function () {
        client.join(null, "ycy_wishing_machine", null, function(){
            console.log("Client joined");
            client.on("stream-added", function(evt){
                console.log("stream-added", evt);
                if (evt.stream.getId() === 1111){
                    console.log("Subscribing stream", evt.stream.getId());
                    client.subscribe(evt.stream);
                }
            });
            client.on("stream-subscribed", function(evt){
                console.log("stream subscribed", evt.stream);
                // document.getElementById("remote-container").innerHTML = "";
                // evt.stream.play("remote-container", {muted: true, controls: true});
                const elem = document.createElement('video');
                elem.srcObject = evt.stream.stream;
                elem.muted = true;
                elem.setAttribute("muted", "muted");
                elem.setAttribute("playsinline", "playsinline");
                elem.setAttribute("style", "width: 100%");
                const container = document.getElementById("video-container");
                container.innerHTML = "";
                container.appendChild(elem);
                elem.play().then(function(){
                    console.log("elem play success");
                }).catch(function (err) {
                    console.error("elem play error", err.error, err.message, err.info, err);
                    elem.setAttribute("controls", "");
                });
            });
        });
    });
</script>
</body>
</html>